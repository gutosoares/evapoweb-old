!function(c){var b=-1,a={onVisible:function(f){var d=a.isSupported();if(!d||!a.hidden()){return f(),d}var g=a.change(function(){a.hidden()||(a.unbind(g),f())});return g},change:function(d){if(!a.isSupported()){return !1}b+=1;var f=b;return a._callbacks[f]=d,a._listen(),f},unbind:function(d){delete a._callbacks[d]},afterPrerendering:function(g){var d=a.isSupported(),h="prerender";if(!d||h!=a.state()){return g(),d}var f=a.change(function(e,j){h!=j&&(a.unbind(f),g())});return f},hidden:function(){return !(!a._doc.hidden&&!a._doc.webkitHidden)},state:function(){return a._doc.visibilityState||a._doc.webkitVisibilityState||"visible"},isSupported:function(){return !(!a._doc.visibilityState&&!a._doc.webkitVisibilityState)},_doc:document||{},_callbacks:{},_change:function(f){var d=a.state();for(var g in a._callbacks){a._callbacks[g].call(a._doc,f,d)}},_listen:function(){if(!a._init){var f="visibilitychange";a._doc.webkitVisibilityState&&(f="webkit"+f);var d=function(){a._change.apply(a,arguments)};a._doc.addEventListener?a._doc.addEventListener(f,d):a._doc.attachEvent(f,d),a._init=!0}}};"undefined"!=typeof module&&module.exports?module.exports=a:c.Visibility=a}(this),function(c){var b=-1,a=function(d){return d.every=function(g,i,f){d._time(),f||(f=i,i=null),b+=1;var h=b;return d._timers[h]={visible:g,hidden:i,callback:f},d._run(h,!1),d.isSupported()&&d._listen(),h},d.stop=function(f){return d._timers[f]?(d._stop(f),delete d._timers[f],!0):!1},d._timers={},d._time=function(){d._timed||(d._timed=!0,d._wasHidden=d.hidden(),d.change(function(){d._stopRun(),d._wasHidden=d.hidden()}))},d._run=function(g,l){var h,k=d._timers[g];if(d.hidden()){if(null===k.hidden){return}h=k.hidden}else{h=k.visible}var e=function(){k.last=new Date,k.callback.call(c)};if(l){var j=new Date,f=j-k.last;h>f?k.delay=setTimeout(function(){e(),k.id=setInterval(e,h)},h-f):(e(),k.id=setInterval(e,h))}else{k.id=setInterval(e,h)}},d._stop=function(g){var f=d._timers[g];clearInterval(f.id),clearTimeout(f.delay),delete f.id,delete f.delay},d._stopRun=function(){var g=d.hidden(),f=d._wasHidden;if(g&&!f||!g&&f){for(var h in d._timers){d._stop(h),d._run(h,!g)}}},d};"undefined"!=typeof module&&module.exports?module.exports=a(require("./visibility.core")):a(c.Visibility)}(window);